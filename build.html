
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Building &#8212; APSW 3.39.4.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="copyright" title="Copyright" href="copyright.html" />
    <link rel="next" title="Extensions" href="extensions.html" />
    <link rel="prev" title="Download" href="download.html" />
 
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-26815066-1']);
  _gaq.push(['_trackPageview']);
</script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="extensions.html" title="Extensions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="download.html" title="Download"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">APSW 3.39.4.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Building</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="building">
<span id="id1"></span><h1>Building<a class="headerlink" href="#building" title="Permalink to this heading">¶</a></h1>
<p>See <a class="reference internal" href="tips.html#version-stuff"><span class="std std-ref">version info</span></a> to understand the
relationship between Python, APSW, and SQLite versions.</p>
<section id="setup-py">
<h2>setup.py<a class="headerlink" href="#setup-py" title="Permalink to this heading">¶</a></h2>
<p>Short story: You run <code class="file docutils literal notranslate"><span class="pre">setup.py</span></code> but you should ideally follow
the <a class="reference internal" href="#recommended-build"><span class="std std-ref">recommended way</span></a> which will also fetch
needed components for you.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 46%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Result</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line">python setup.py install test</div>
</div>
</td>
<td><p>Compiles APSW with default Python compiler, installs it into Python
site library directory and then runs the test suite.</p></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">python setup.py install <code class="xref std std-option docutils literal notranslate"><span class="pre">--user</span></code></div>
</div>
</td>
<td><p>Compiles APSW with default Python
compiler and installs it into a subdirectory of your home directory.
See <span class="target" id="index-0"></span><a class="pep reference external" href="https://peps.python.org/pep-0370/"><strong>PEP 370</strong></a> for more details.</p></td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">python setup.py build_ext <code class="xref std std-option docutils literal notranslate"><span class="pre">--force</span></code>
<code class="xref std std-option docutils literal notranslate"><span class="pre">--inplace</span></code> test</div>
</div>
</td>
<td><p>Compiles the extension but doesn’t install it.  The test suite is then
run.</p></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">python setup.py build <code class="xref std std-option docutils literal notranslate"><span class="pre">--debug</span></code> install</div>
</div>
</td>
<td><p>Compiles APSW with debug information.  This also turns on <a class="reference external" href="http://en.wikipedia.org/wiki/Assert.h">assertions</a>
in APSW that double check the code assumptions.  If you are using the
SQLite amalgamation then assertions are turned on in that too.  Note
that this will considerably slow down APSW and SQLite.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="additional-setup-py-flags">
<span id="setup-py-flags"></span><h2>Additional <code class="file docutils literal notranslate"><span class="pre">setup.py</span></code> flags<a class="headerlink" href="#additional-setup-py-flags" title="Permalink to this heading">¶</a></h2>
<p>There are a number of APSW specific flags to commands you can specify.</p>
<section id="fetch">
<h3>fetch<a class="headerlink" href="#fetch" title="Permalink to this heading">¶</a></h3>
<p><code class="file docutils literal notranslate"><span class="pre">setup.py</span></code> can automatically fetch SQLite and other optional
components.  You can set the environment variable <code class="xref py py-const docutils literal notranslate"><span class="pre">http_proxy</span></code>
to control proxy usage for the download.</p>
<p>If any files are downloaded then the build step will automatically use
them.  This still applies when you do later builds without
re-fetching.</p>
<blockquote>
<div><div class="line-block">
<div class="line">python setup.py fetch <em>options</em></div>
</div>
</div></blockquote>
<table class="docutils align-default">
<colgroup>
<col style="width: 32%" />
<col style="width: 68%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>fetch flag</p></th>
<th class="head"><p>Result</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line"><code class="xref std std-option docutils literal notranslate"><span class="pre">--version=VERSION</span></code></div>
</div>
</td>
<td><p>By default the SQLite version corresponding to the APSW release is retrieved,  You
can also ask for specific versions, or for <cite>latest</cite> which uses the SQLite download
page to work out the most recent version.</p></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line"><code class="xref std std-option docutils literal notranslate"><span class="pre">--missing-checksum-ok</span></code></div>
</div>
</td>
<td><p>Allows setup to continue if the <a class="reference internal" href="#fetch-checksums"><span class="std std-ref">checksum</span></a> is missing.</p></td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line"><code class="xref std std-option docutils literal notranslate"><span class="pre">--all</span></code></div>
</div>
</td>
<td><p>Gets all components listed below.</p></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line"><code class="xref std std-option docutils literal notranslate"><span class="pre">--sqlite</span></code></div>
</div>
</td>
<td><p>Automatically downloads the <a class="reference external" href="https://sqlite.org/amalgamation.html">SQLite amalgamation</a>. The amalgamation is the
preferred way to use SQLite as you have total control over what components are
included or excluded (see below) and have no dependencies on any existing
libraries on your developer or deployment machines. The amalgamation includes the
fts3/4/5, rtree, json1 and icu extensions. On non-Windows platforms, any existing
<code class="file docutils literal notranslate"><span class="pre">sqlite3/</span></code> directory will be erased and the downloaded code placed in a newly
created <code class="file docutils literal notranslate"><span class="pre">sqlite3/</span></code> directory.</p></td>
</tr>
</tbody>
</table>
<div class="admonition note" id="fetch-checksums">
<p class="admonition-title">Note</p>
<p>The SQLite downloads are not <a class="reference external" href="http://en.wikipedia.org/wiki/Digital_signature">digitally signed</a> which means you
have no way of verifying they were produced by the SQLite team or
were not modified between the SQLite servers and your computer.</p>
<p>Consequently APSW ships with a <a class="reference external" href="https://github.com/rogerbinns/apsw/blob/master/checksums">checksums file</a>
that includes checksums for the various SQLite downloads.  If the
download does not match the checksum then it is rejected and an
error occurs.</p>
<p>The SQLite download page is not checksummed, so in theory a bad guy
could modify it to point at a malicious download version instead.
(setup only uses the page to determine the current version number -
the SQLite download site URL is hard coded.)</p>
<p>If the URL is not listed in the checksums file then setup aborts.
You can use <code class="xref std std-option docutils literal notranslate"><span class="pre">--missing-checksum-ok</span></code> to continue.  You are
recommended instead to update the checksums file with the
correct information.</p>
</div>
<div class="admonition note" id="fetch-configure">
<p class="admonition-title">Note</p>
<p>(This note only applies to non-Windows platforms.)  By default the
amalgamation will work on your platform.  It detects
the operating system (and compiler if relevant) and uses the
appropriate APIs.  However it then only uses the oldest known
working APIs.  For example it will use the <em>sleep</em> system call.
More recent APIs may exist but the amalgamation needs to be told
they exist.  As an example <em>sleep</em> can only sleep in increments of
one second while the <em>usleep</em> system call can sleep in increments of
one microsecond. The default SQLite busy handler does small sleeps
(eg 1/50th of a second) backing off as needed.  If <em>sleep</em> is used
then those will all be a minimum of a second.  A second example is
that the traditional APIs for getting time information are not
re-entrant and cannot be used concurrently from multiple threads.
Consequently SQLite has mutexes to ensure that concurrent calls do
not happen.  However you can tell it you have more recent re-entrant
versions of the calls and it won’t need to bother with the mutexes.</p>
<p>After fetching the amalgamation, setup automatically determines what
new APIs you have by running the <code class="file docutils literal notranslate"><span class="pre">configure</span></code> script that comes
with SQLite and noting the output.  The information is placed in
<code class="file docutils literal notranslate"><span class="pre">sqlite3/sqlite3config.h</span></code>.  The build stage will automatically
take note of this as needed.</p>
</div>
</section>
<section id="build-build-ext">
<span id="setup-build-flags"></span><h3>build/build_ext<a class="headerlink" href="#build-build-ext" title="Permalink to this heading">¶</a></h3>
<p>You can enable or omit certain functionality by specifying flags to
the build and/or build_ext commands of <code class="file docutils literal notranslate"><span class="pre">setup.py</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">build</span> <span class="o">*</span><span class="n">options</span><span class="o">*</span>
</pre></div>
</div>
<p>Note that the options do not accumulate.  If you want to specify multiple enables or omits then you
need to give the flag once and giving a comma separated list.  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">build</span> <span class="o">--</span><span class="n">enable</span><span class="o">=</span><span class="n">fts3</span><span class="p">,</span><span class="n">fts3_parenthesis</span><span class="p">,</span><span class="n">rtree</span><span class="p">,</span><span class="n">icu</span>
</pre></div>
</div>
<p>SQLite includes <a class="reference external" href="https://www.sqlite.org/compile.html">many options defined to the C compiler</a>.  If you want to change
compiled in default values, or provide defines like
SQLITE_CUSTOM_INCLUDE then you can use <code class="xref std std-option docutils literal notranslate"><span class="pre">--definevalues</span></code> using
<cite>=</cite> and comma separating.  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">build_ext</span> <span class="o">--</span><span class="n">definevalues</span> <span class="n">SQLITE_DEFAULT_FILE_FORMAT</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">SQLITE_CUSTOM_INCLUDE</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">h</span>
</pre></div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 32%" />
<col style="width: 68%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>build/build_ext flag</p></th>
<th class="head"><p>Result</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line"><code class="xref std std-option docutils literal notranslate"><span class="pre">--enable-all-extensions</span></code></div>
</div>
</td>
<td><p>Enables the STAT4, FTS3/4/5, RTree, JSON1, RBU, and ICU extensions if <em>icu-config</em>
is on your path</p></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line"><code class="xref std std-option docutils literal notranslate"><span class="pre">--enable=fts3</span></code></div>
<div class="line"><code class="xref std std-option docutils literal notranslate"><span class="pre">--enable=fts4</span></code></div>
<div class="line"><code class="xref std std-option docutils literal notranslate"><span class="pre">--enable=fts5</span></code></div>
</div>
</td>
<td><p>Enables the <a class="reference internal" href="extensions.html#ext-fts3"><span class="std std-ref">full text search extension</span></a>.
This flag only helps when using the amalgamation. If not using the
amalgamation then you need to separately ensure fts3/4/5 is enabled in the SQLite
install. You are likely to want the <a class="reference external" href="https://sqlite.org/compile.html#enable_fts3_parenthesis">parenthesis option</a> on unless you have
legacy code (<cite>–enable-all-extensions</cite> turns it on).</p></td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line"><code class="xref std std-option docutils literal notranslate"><span class="pre">--enable=rtree</span></code></div>
</div>
</td>
<td><p>Enables the <a class="reference internal" href="extensions.html#ext-rtree"><span class="std std-ref">spatial table extension</span></a>.
This flag only helps when using the amalgamation. If not using the
amalgamation then you need to separately ensure rtree is enabled in the SQLite
install.</p></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line"><code class="xref std std-option docutils literal notranslate"><span class="pre">--enable=rbu</span></code></div>
</div>
</td>
<td><p>Enables the <a class="reference internal" href="extensions.html#ext-rbu"><span class="std std-ref">reumable bulk update extension</span></a>.
This flag only helps when using the amalgamation. If not using the
amalgamation then you need to separately ensure rbu is enabled in the SQLite
install.</p></td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line"><code class="xref std std-option docutils literal notranslate"><span class="pre">--enable=icu</span></code></div>
</div>
</td>
<td><p>Enables the <a class="reference internal" href="extensions.html#ext-icu"><span class="std std-ref">International Components for Unicode extension</span></a>.
Note that you must have the ICU libraries on your machine which setup will
automatically try to find using <code class="file docutils literal notranslate"><span class="pre">icu-config</span></code>.
This flag only helps when using the amalgamation. If not using the
amalgamation then you need to separately ensure ICU is enabled in the SQLite
install.</p></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line"><code class="xref std std-option docutils literal notranslate"><span class="pre">--omit=ITEM</span></code></div>
</div>
</td>
<td><p>Causes various functionality to be omitted. For example
<code class="xref std std-option docutils literal notranslate"><span class="pre">--omit=load_extension</span></code> will omit code to do with loading extensions. If
using the amalgamation then this will omit the functionality from APSW and
SQLite, otherwise the functionality will only be omitted from APSW (ie the code
will still be in SQLite, APSW just won’t call it). In almost all cases you will need
to regenerate the SQLite source because the omits also alter the generated SQL
parser. See <a class="reference external" href="https://sqlite.org/compile.html#omitfeatures">the relevant SQLite documentation</a>.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="matching-apsw-and-sqlite-options">
<span id="matching-sqlite-options"></span><h2>Matching APSW and SQLite options<a class="headerlink" href="#matching-apsw-and-sqlite-options" title="Permalink to this heading">¶</a></h2>
<p>APSW needs to see the same options as SQLite to correctly match it.
For example if SQLite is compiled without loadable extensions, then
APSW also needs to know that at compile time because the APIs won’t be
present.  Another example is <code class="xref py py-attr docutils literal notranslate"><span class="pre">Cursor.description_full</span></code> needs to
know if <cite>SQLITE_ENABLE_COLUMN_METADATA</cite> was defined when building
SQLite for the same reason.</p>
<p>If you use the amalgamation (recommended configuration) then APSW and
SQLite will see the same options and will be correctly in sync.</p>
<p>If you are using the system provided SQLite then specify
<cite>–use-system-sqlite-config</cite> to <cite>build_ext</cite>, and the configuration
will be automatically obtained (using <a class="reference external" href="https://docs.python.org/3/library/ctypes.html?highlight=find_library#ctypes.util.find_library">ctypes find_library</a>)</p>
<p>You can use the amalgamation and <cite>–use-system-sqlite-config</cite>
simultaneously in which case the amalgamation will have an identical
configuration to the system one.  This is useful if you are using a
newer SQLite version in the amalgamation, but still want to match the
system.</p>
</section>
<section id="finding-sqlite-3">
<h2>Finding SQLite 3<a class="headerlink" href="#finding-sqlite-3" title="Permalink to this heading">¶</a></h2>
<p>SQLite 3 is needed during the build process. If you specify
<code class="xref std std-option docutils literal notranslate"><span class="pre">fetch</span> <span class="pre">--sqlite</span></code> to the <code class="file docutils literal notranslate"><span class="pre">setup.py</span></code> command line
then it will automatically fetch the current version of the SQLite
amalgamation. (The current version is determined by parsing the
<a class="reference external" href="https://sqlite.org/download.html">SQLite download page</a>). You
can manually specify the version, for example
<code class="xref std std-option docutils literal notranslate"><span class="pre">fetch</span> <span class="pre">--sqlite</span> <span class="pre">--version=3.7.4</span></code>.</p>
<p>These methods are tried in order:</p>
<blockquote>
<div><p><a class="reference external" href="https://sqlite.org/amalgamation.html">Amalgamation</a></p>
<blockquote>
<div><p>The file <code class="file docutils literal notranslate"><span class="pre">sqlite3.c</span></code> and then <code class="file docutils literal notranslate"><span class="pre">sqlite3/sqlite3.c</span></code> is
looked for. The SQLite code is then statically compiled into the
APSW extension and is invisible to the rest of the
process. There are no runtime library dependencies on SQLite as
a result.  When you use <code class="xref std std-option docutils literal notranslate"><span class="pre">fetch</span></code> this is where it places
the downloaded amalgamation.</p>
</div></blockquote>
<p>Local build</p>
<blockquote>
<div><p>The header <code class="file docutils literal notranslate"><span class="pre">sqlite3/sqlite3.h</span></code> and library <code class="file docutils literal notranslate"><span class="pre">sqlite3/libsqlite3.</span><em><span class="pre">a,so,dll</span></em></code> is looked for.</p>
</div></blockquote>
<p>User directories</p>
<blockquote>
<div><p>If specifying <code class="xref std std-option docutils literal notranslate"><span class="pre">--user</span></code> then your user directory is
searched first. See <span class="target" id="index-1"></span><a class="pep reference external" href="https://peps.python.org/pep-0370/"><strong>PEP 370</strong></a> for more details.</p>
</div></blockquote>
<p>System directories</p>
<blockquote>
<div><p>The default compiler include path (eg <code class="file docutils literal notranslate"><span class="pre">/usr/include</span></code>) and library path (eg <code class="file docutils literal notranslate"><span class="pre">/usr/lib</span></code>) are used.</p>
</div></blockquote>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you compiled SQLite with any OMIT flags (eg
<code class="xref py py-const docutils literal notranslate"><span class="pre">SQLITE_OMIT_LOAD_EXTENSION</span></code>) then you must include them in
the <code class="file docutils literal notranslate"><span class="pre">setup.py</span></code> command or file. For this example you could use
<code class="xref std std-option docutils literal notranslate"><span class="pre">setup.py</span> <span class="pre">build</span> <span class="pre">--omit=load_extension</span></code> to add the same flags.</p>
</div>
</section>
<section id="recommended">
<span id="recommended-build"></span><h2>Recommended<a class="headerlink" href="#recommended" title="Permalink to this heading">¶</a></h2>
<p>These instructions show how to build automatically downloading and
using the amalgamation plus other <a class="reference internal" href="extensions.html#extensions"><span class="std std-ref">Extensions</span></a>. Any existing SQLite on
your system is ignored at build time and runtime. (Note that you can
even use APSW in the same process as a different SQLite is used by
other libraries - this happens a lot on Mac.) You should follow these
instructions with your current directory being where you extracted the
APSW source to.</p>
<blockquote>
<div><p>Windows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">fetch</span> <span class="o">--</span><span class="nb">all</span> <span class="n">build</span> <span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="nb">all</span><span class="o">-</span><span class="n">extensions</span> <span class="n">install</span> <span class="n">test</span>
</pre></div>
</div>
<p>Mac/Linux etc:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python setup.py fetch --all build --enable-all-extensions install test
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There may be some warnings during the compilation step about
sqlite3.c, <a class="reference external" href="https://sqlite.org/faq.html#q17">but they are harmless</a></p>
</div>
<p>The extension just turns into a single file apsw.so (Linux/Mac) or
apsw.pyd (Windows). (More complicated name on Pythons implementing
<span class="target" id="index-2"></span><a class="pep reference external" href="https://peps.python.org/pep-3149/"><strong>PEP 3149</strong></a>). You don’t need to install it and can drop it into any
directory that is more convenient for you and that your code can
reach. To just do the build and not install, leave out <em>install</em> from
the lines above. (Use <em>build_ext –inplace</em> to have the extension put
in the main directory.)</p>
<p>The test suite will be run. It will print the APSW file used, APSW and
SQLite versions and then run lots of tests all of which should pass.</p>
</section>
<section id="source-distribution-advanced">
<h2>Source distribution (advanced)<a class="headerlink" href="#source-distribution-advanced" title="Permalink to this heading">¶</a></h2>
<p>If you want to make a source distribution or a binary distribution
that creates an intermediate source distribution such as <cite>bdist_rpm</cite>
then you can have the SQLite amalgamation automatically included as
part of it.  If you specify the fetch command as part of the same
command line then everything fetched is included in the source
distribution.  For example this will fetch all components, include
them in the source distribution and build a rpm using those
components:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python setup.py fetch --all bdist_rpm
</pre></div>
</div>
</section>
<section id="testing">
<span id="id2"></span><h2>Testing<a class="headerlink" href="#testing" title="Permalink to this heading">¶</a></h2>
<p>SQLite itself is <a class="reference external" href="https://sqlite.org/testing.html">extensively tested</a>. It has considerably more code
dedicated to testing than makes up the actual database functionality.</p>
<p>APSW includes tests which use the standard Python testing modules to
verify correct operation. New code is developed alongside the tests.
Reported issues also have test cases to ensure the issue doesn’t
happen or doesn’t happen again.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python3 -m apsw.tests
                Python  /usr/bin/python3 sys.version_info(major=3, minor=10, micro=4, releaselevel=&#39;final&#39;, serial=0)
Testing with APSW file  /space/apsw/apsw/__init__.cpython-310-x86_64-linux-gnu.so
          APSW version  3.39.2.0
    SQLite lib version  3.39.2
SQLite headers version  3039002
    Using amalgamation  True
...............................................................................................
----------------------------------------------------------------------
Ran 95 tests in 25.990s

OK
</pre></div>
</div>
<p>The tests also ensure that as much APSW code as possible is executed
including alternate paths through the code.  95.5% of the APSW code is
executed by the tests. If you checkout the APSW source then there is a
script <a class="reference external" href="https://github.com/rogerbinns/apsw/blob/master/tools/coverage.sh">tools/coverage.sh</a> that enables extra code that
deliberately induces extra conditions such as memory allocation
failures, SQLite returning undocumented error codes etc. That brings
coverage up to 99.6% of the code.</p>
<p>A memory checker <a class="reference external" href="http://valgrind.org">Valgrind</a> is used while
running the test suite. The test suite is run multiple times to make
any memory leaks or similar issues stand out. A checking version of
Python is also used.  See <a class="reference external" href="https://github.com/rogerbinns/apsw/blob/master/tools/valgrind.sh">tools/valgrind.sh</a> in the source.
The same testing is also done with the <a class="reference external" href="https://en.wikipedia.org/wiki/AddressSanitizer">compiler’s sanitizer option</a>.</p>
<p>To ensure compatibility with the various Python versions, a script
downloads and compiles all supported Python versions in both debug and
release configurations (and 32 and 64 bit) against the APSW and SQLite
supported versions running the tests. See <a class="reference external" href="https://github.com/rogerbinns/apsw/blob/master/tools/megatest.py">tools/megatest.py</a>
in the source.</p>
<p>In short both SQLite and APSW have a lot of testing!</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Building</a><ul>
<li><a class="reference internal" href="#setup-py">setup.py</a></li>
<li><a class="reference internal" href="#additional-setup-py-flags">Additional <code class="file docutils literal notranslate"><span class="pre">setup.py</span></code> flags</a><ul>
<li><a class="reference internal" href="#fetch">fetch</a></li>
<li><a class="reference internal" href="#build-build-ext">build/build_ext</a></li>
</ul>
</li>
<li><a class="reference internal" href="#matching-apsw-and-sqlite-options">Matching APSW and SQLite options</a></li>
<li><a class="reference internal" href="#finding-sqlite-3">Finding SQLite 3</a></li>
<li><a class="reference internal" href="#recommended">Recommended</a></li>
<li><a class="reference internal" href="#source-distribution-advanced">Source distribution (advanced)</a></li>
<li><a class="reference internal" href="#testing">Testing</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="download.html"
                          title="previous chapter">Download</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="extensions.html"
                          title="next chapter">Extensions</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/build.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="extensions.html" title="Extensions"
             >next</a> |</li>
        <li class="right" >
          <a href="download.html" title="Download"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">APSW 3.39.4.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Building</a></li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; <a href="copyright.html">Copyright</a> 2004-2022, Roger Binns &lt;rogerb@rogerbinns.com&gt;.
      Last updated on Oct 09, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.2.0.
    </div>
<div class="footer">This page uses <a href="http://analytics.google.com/">
Google Analytics</a> to collect statistics. You can disable it by blocking
the JavaScript coming from www.google-analytics.com.
<script type="text/javascript">
  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ?
              'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>
</div>

  </body>
</html>